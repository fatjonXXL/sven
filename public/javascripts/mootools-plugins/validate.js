var Validate=new Class({getOptions:function(){return{validateOnBlur:true,errorClass:"error",errorMsgClass:"errorMessage",dateFormat:"dd/MM/yy",onFail:Class.empty,onSuccess:false,showErrorsInline:true,label:"Please wait..."}},initialize:function(b,a){this.setOptions(this.getOptions(),a);this.form=$(b);this.elements=this.form.getElements(".required");this.list=[];this.elements.each(function(d,c){if(this.options.validateOnBlur){d.addEvent("blur",this.validate.bind(this,d))}}.bind(this));this.form.addEvent("submit",function(f){var c=new Event(f);var d=true;this.elements.each(function(g,e){if(!this.validate(g)){c.stop();d=false;this.list.include(g)}else{this.list.remove(g)}}.bind(this));if(d){if(this.options.onSuccess){c.stop();this.options.onSuccess(this.form)}else{this.form.getElement("input[type=submit]").setProperty("value",this.options.label)}}else{this.options.onFail(this.getList())}}.bind(this))},getList:function(){var a=new Element("ul");this.list.each(function(d,c){if(d.title!=""){var b=new Element("li").injectInside(a);new Element("label").setProperty("for",d.id).setText(d.title).injectInside(b)}});return a},validate:function(c){var f=true;this.clearMsg(c);switch(c.type){case"text":case"textarea":case"select-one":if(c.value!=""){if(c.hasClass("email")){var g=/^[A-Z0-9._%-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/;if(c.value.toUpperCase().match(g)){f=true}else{f=false;this.setMsg(c,"Please enter a valid email address")}}if(c.hasClass("number")){var h=/[-+]?[0-9]*\.?[0-9]+/;if(c.value.match(h)){f=true}else{f=false;this.setMsg(c,"Please enter a valid number")}}if(c.hasClass("postcode")){var e=/^([Gg][Ii][Rr] 0[Aa]{2})|((([A-Za-z][0-9]{1,2})|(([A-Za-z][A-Ha-hJ-Yj-y][0-9]{1,2})|(([A-Za-z][0-9][A-Za-z])|([A-Za-z][A-Ha-hJ-Yj-y][0-9]?[A-Za-z])))) [0-9][A-Za-z]{2})$/;if(c.value.match(e)){f=true}else{f=false;this.setMsg(c,"Please enter a valid postcode")}}if(c.hasClass("date")){var i=Date.parseExact(c.value,this.options.dateFormat);if(i!=null){f=true}else{f=false;this.setMsg(c,"Please enter a valid date in the format: "+this.options.dateFormat.toLowerCase())}}}else{f=false;this.setMsg(c)}break;case"checkbox":if(!c.checked){f=false;this.setMsg(c)}else{f=true}break;case"radio":var a=$A(this.form[c.name]);var b=false;a.each(function(j,d){if(j.checked){b=true}});if(!b){f=false;this.setMsg(a.getLast(),"Please select an option")}else{f=true;this.clearMsg(a.getLast())}break}return f},setMsg:function(a,b){if(b==undefined){b=a.title}if(this.options.showErrorsInline){if(a.error==undefined){a.error=new Element("span").addClass(this.options.errorMsgClass).setText(b).injectAfter(a)}else{a.error.setText(b)}a.addClass(this.options.errorClass)}},clearMsg:function(a){a.removeClass(this.options.errorClass);if(a.error!=undefined){a.error.remove();a.error=undefined}}});Validate.implement(new Options);Validate.implement(new Events);